<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Importar Archivo Excel</title>
    
<link href="/css/bootstrap.min.css" rel="stylesheet" type="text/css" crossorigin="anonymous" />
<link href="/css/sidebars.css" rel="stylesheet" type="text/css" crossorigin="anonymous" />
<script type="text/javascript" src="/js/sidebars.js"></script>
<script type="text/javascript" src="/js/bootstrap.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"></script>


<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=PT+Sans:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
<link href="/css/estilos.css" rel="stylesheet" type="text/css" crossorigin="anonymous" />
<    
    
</head>
<body>
<br><br>
<div class="container">
	<h1><span><a class="btn"  th:href="@{/matricula}" data-toggle="tooltip" data-placement="bottom" title="Volver a matrículas"><i class="fa-sharp fa-solid fa-chevron-left"></i></a></span> Carga masiva matrículas</h1>
	
    <br>
    <div class="row">
    	<div class="col">
    		<!-- Formulario para subir archivo Excel -->
		    <form th:action="@{/upload}" method="post" enctype="multipart/form-data">
		        <input class="form-control" type="file" name="file" accept=".xls,.xlsx" />
		    	<!-- Mensaje de resultado de la carga -->
		    	<p th:text="${message}"></p>

    	</div>
    	<div class="col">
    			<button class="btn btn-primary" type="submit">Importar</button>
		    </form>

    	</div>
    	<div class="col"></div>
    </div>
    

<div class="table-responsive">
	<h5>Matrículas</h5>
    <!-- Tabla para mostrar los datos del archivo Excel -->
    <table class="table table-bordered text-center border rounded container shadow" border="1" th:if="${excelData != null && excelData.size() > 0}">
        <thead class="text-uppercase">
            <tr>
                <th>#</th>
                <th th:each="header : ${excelData[0]}" th:text="${header}"></th>
            </tr>
        </thead>
        <tbody>
            <tr th:each="rowData, rowStat : ${excelData}" th:if="${rowStat.index > 0}">
                <td th:text="${rowStat.index}"></td>
                <td th:each="cellData : ${rowData}" th:text="${cellData}"></td>
            </tr>
        </tbody>
    </table>
    
</div>   	
</div>
    </body>
</html>
