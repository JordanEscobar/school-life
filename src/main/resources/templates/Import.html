<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Importar Archivo Excel</title>
    
    <link href="/css/bootstrap.min.css" rel="stylesheet" type="text/css" crossorigin="anonymous" />
    <link href="/css/sidebars.css" rel="stylesheet" type="text/css" crossorigin="anonymous" />
    <script type="text/javascript" src="/js/sidebars.js"></script>
    <script type="text/javascript" src="/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=PT+Sans:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
    <link href="/css/estilos.css" rel="stylesheet" type="text/css" crossorigin="anonymous" />
</head>
<body>
<br><br>
<div class="container">
    <h1><span><a class="btn" th:href="@{/matricula}" data-toggle="tooltip" data-placement="bottom" title="Volver a matrículas"><i class="fa-sharp fa-solid fa-chevron-left"></i></a></span> Carga masiva matrículas</h1>
    
    <br>
    <div class="row">
        <div class="col">
            <!-- Formulario para subir archivo Excel -->
            <form th:action="@{/upload}" method="post" enctype="multipart/form-data">
                <input class="form-control" type="file" name="file" accept=".xls,.xlsx" />
                <!-- Mensaje de resultado de la carga -->
                <p th:text="${message}"></p>

        </div>
        <div class="col">
                <button class="btn btn-primary" type="submit">Importar</button>
            </form>

        </div>
        <div class="col"></div>
    </div>
    

<div class="table-responsive">
    <h3>Matrículas</h3>
    <!-- Tabla para mostrar los datos del archivo Excel -->
	<br>
	<h5 th:if="${excelData != null && excelData.size() > 0}">Información del estudiante</h5>
    <table class="table table-bordered text-center border rounded container shadow" th:if="${excelData != null && excelData.size() > 0}">
        <thead>
            <tr>
                <th>RUT</th>
                <th>NOMBRE</th>
                <th>APELLIDO PATERNO</th>
                <th>APELLIDO MATERNO</th>
                <th>N° MATRÍCULA</th>
                <th>FECHA MATRÍCULA</th>
                <th>FECHA NACIMIENTO</th>
                <th>PAÍS NACIMIENTO</th>
                <th>GÉNERO</th>
                <th>DIRECCIÓN</th>
                <th>COMUNA</th>
                <th>CORREO ELECTRÓNICO</th>
                <th>TELÉFONO</th>
                <th>CELULAR</th>
                <th>COLEGIO PROCEDENCIA</th>
                <th>CONTACTO EMERGENCIA</th>
                <th>TELÉFONO EMERGENCIA</th>
                <th>VIVE CON</th>
                <th>N° COMPUTADORES CASA</th>
                <th>RELIGIÓN</th>
                <th>ACEPTA CLASES RELIGIÓN</th>
                <th>BECA</th>
                <th>ESTATURA</th>
                <th>PESO</th>
                <th>GRUPO SANGUINEO</th>
                <th>ALERGIA ALIMENTOS</th>
                <th>ALERGIA MEDICAMENTOS</th>
                <th>MEDICAMENTOS CONTRAINDICADOS</th>
                <th>ENFERMEDADES CRÓNICAS</th>
                <th>VACUNA COVID</th>
                <th>N° VACUNAS COVID</th>
                <th>ESQUEMA COMPLETO VACUNACIÓN COVID</th>
                <th>FECHA ULTIMA VACUNA COVID</th>
                <th>APTO EDUCACIÓN FÍSICA</th>
                <th>SISTEMA PREVISIÓN</th>
                <th>SEGURO ESCOLAR PRIVADO</th>
                <th>NACIONALIDAD</th>
                <th>ETNIA</th>
                <th>CONSULTORIO CLÍNICA</th>
                <th>OBSERVACIONES</th>
                <th>ESTADO MATRÍCULA</th>
                <th>ESTABLECIMIENTO</th>
                <th>CURSO</th>
                <th>ES ALUMNO PIE</th>
            </tr> 
        </thead>
        <tbody>
            <tr th:each="e : ${estudiantes}">
            	<td th:text="${e.get(0)}"></td>
            	<td th:text="${e.get(1)}"></td>
            	<td th:text="${e.get(2)}"></td>
            	<td th:text="${e.get(3)}"></td>
            	<td th:text="${e.get(4)}"></td>
            	<td th:text="${e.get(5)}"></td>
            	<td th:text="${e.get(6)}"></td>
            	<td th:text="${e.get(7)}"></td>
            	<td th:text="${e.get(8)}"></td>
            	<td th:text="${e.get(9)}"></td>
            	<td th:text="${e.get(10)}"></td>
            	<td th:text="${e.get(11)}"></td>
            	<td th:text="${e.get(12)}"></td>
            	<td th:text="${e.get(13)}"></td>
            	<td th:text="${e.get(14)}"></td>
            	<td th:text="${e.get(15)}"></td>
            	<td th:text="${e.get(16)}"></td>
            	<td th:text="${e.get(17)}"></td>
            	<td th:text="${e.get(18)}"></td>
            	<td th:text="${e.get(19)}"></td>
            	<td th:text="${e.get(20)}"></td>
            	<td th:text="${e.get(21)}"></td>
            	<td th:text="${e.get(22)}"></td>
            	<td th:text="${e.get(23)}"></td>
            	<td th:text="${e.get(24)}"></td>
            	<td th:text="${e.get(25)}"></td>
            	<td th:text="${e.get(26)}"></td>
            	<td th:text="${e.get(27)}"></td>
            	<td th:text="${e.get(28)}"></td>
            	<td th:text="${e.get(29)}"></td>
            	<td th:text="${e.get(30)}"></td>
            	<td th:text="${e.get(31)}"></td>
            	<td th:text="${e.get(32)}"></td>
            	<td th:text="${e.get(33)}"></td>
            	<td th:text="${e.get(34)}"></td>
            	<td th:text="${e.get(35)}"></td>
            	<td th:text="${e.get(36)}"></td>
            	<td th:text="${e.get(37)}"></td>
            	<td th:text="${e.get(38)}"></td>
            	<td th:text="${e.get(39)}"></td>
            	<td th:text="${e.get(40)}"></td>
				<td th:text="${e.get(41)}"></td>
            	<td th:text="${e.get(42)}"></td>
            	<td th:text="${e.get(43)}"></td>
            </tr>
        </tbody>
    </table>
    <br>
    <h5 th:if="${excelData != null && excelData.size() > 0}">Información del apoderado</h5>
    <table class="table table-bordered text-center border rounded container shadow" th:if="${excelData != null && excelData.size() > 0}">
        <thead>
            <tr>
                <th>RUT APODERADO</th>
                <th>RUT ESTUDIANTE</th>
                <th>NÚMERO DE DOCUMENTO</th>
                <th>NOMBRES</th>
                <th>APELLIDO PATERNO</th>
                <th>APELLIDO MATERNO</th>
                <th>PASAPORTE</th>
                <th>PARENTESCO</th>
                <th>TIPO DE APODERADO</th>
                <th>FECHA DE NACIMIENTO</th>
                <th>DOMICILIO</th>
                <th>COMUNA</th>
                <th>NIVEL EDUCACIÓN</th>
                <th>OCUPACIÓN</th>
                <th>TELÉFONO</th>
                <th>CELULAR</th>
                <th>CORREO ELECTRÓNICO</th>
                <th>ES TUTOR</th>
                <th>ACEPTA MANUAL DE CONVIVENCIA ESCOLAR</th>
                <th>AUTORIZACIÓN FOTOGRAFÍA O GRABACIÓN</th>
                <th>AUTORIZADO RETIRAR DE ESTABLECIMIENTO</th>
                <th>ESTADO CIVIL</th>
            </tr> 
        </thead>
        <tbody>
            <tr th:each="a : ${apoderados}">
            	<td th:text="${a.get(0)}"></td>
            	<td th:text="${a.get(1)}"></td>
            	<td th:text="${a.get(2)}"></td>
            	<td th:text="${a.get(3)}"></td>
            	<td th:text="${a.get(4)}"></td>
            	<td th:text="${a.get(5)}"></td>
            	<td th:text="${a.get(6)}"></td>
            	<td th:text="${a.get(7)}"></td>
            	<td th:text="${a.get(8)}"></td>
            	<td th:text="${a.get(9)}"></td>
            	<td th:text="${a.get(10)}"></td>
            	<td th:text="${a.get(11)}"></td>
            	<td th:text="${a.get(12)}"></td>
            	<td th:text="${a.get(13)}"></td>
            	<td th:text="${a.get(14)}"></td>
            	<td th:text="${a.get(15)}"></td>
            	<td th:text="${a.get(16)}"></td>
            	<td th:text="${a.get(17)}"></td>
            	<td th:text="${a.get(18)}"></td>
            	<td th:text="${a.get(19)}"></td>
            	<td th:text="${a.get(20)}"></td>
            	<td th:text="${a.get(21)}"></td>   
            </tr>
        </tbody>
    </table>
    <br>
    <h5 th:if="${excelData != null && excelData.size() > 0}">Información del programa de integración</h5>
    <table class="table table-bordered text-center border rounded container shadow" th:if="${excelData != null && excelData.size() > 0}">
        <thead>
            <tr>
                <th>PROGRAMA ID</th>
                <th>RUT ESTUDIANTE</th>
                <th>PERMANENCIA</th>
                <th>TIPO DE PERMANENCIA</th>
                <th>INDICACIONES GENERALES</th>
            </tr> 
        </thead>
        <tbody>
            <tr th:each="p : ${programa}">
            	<td th:text="${p.get(0)}"></td>
            	<td th:text="${p.get(1)}"></td>
            	<td th:text="${p.get(2)}"></td>
            	<td th:text="${p.get(3)}"></td>
            	<td th:text="${p.get(4)}"></td>   
            </tr>
        </tbody>
    </table>
</div>
</div>
<br><br>
</body>
</html>
