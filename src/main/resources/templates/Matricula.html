<!DOCTYPE html>
<html xmlns="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Libro de clases online</title>
<link href="/css/bootstrap.min.css" rel="stylesheet" type="text/css" crossorigin="anonymous" />
<link href="/css/sidebars.css" rel="stylesheet" type="text/css" crossorigin="anonymous" />
<script type="text/javascript" src="/js/sidebars.js"></script>
<script type="text/javascript" src="/js/bootstrap.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"></script>

</head>
<body>

<nav class="navbar bg-dark border-bottom border-body" data-bs-theme="dark">
	<div>
		<a th:href="@{/}"  data-toggle="tooltip" data-placement="bottom" title="volver a inicio" class="btn btn-outline-light  border-dark" aria-disabled="true"><i class="fa-solid fa-house-chimney"></i></a> <span class="text-light">NOMBRE ESCUELA</span>
	</div>
	
	<div class="d-flex justify-content-end">
		<a class="btn btn-outline-danger shadow" th:href="@{/login}" data-toggle="tooltip" data-placement="bottom" title="Presione para cerrar la sesión"><i class="fa-solid fa-power-off"></i>&nbsp;Cerrar Sesión</a>
	</div>
</nav>
<br><br>
<div class="container">
	<div class="col-md-4 mt-5">
		<div class="alert alert-success" th:if="${success} != null" th:text="${success}"></div>	
	</div>
	<h1 class=""><span><a class="btn"  th:href="@{/}" data-toggle="tooltip" data-placement="bottom" title="Volver a inicio"><i class="fa-sharp fa-solid fa-chevron-left"></i></a></span> Matrícula</h1>
	<br>
	<div class="d-flex justify-content-end">
		<a th:href="@{/programa/pie}" class="btn btn-warning text-light shadow" data-toggle="tooltip" data-placement="bottom" title="Ingresar estudiante a programa Pie">+ Programa Pie</a> &nbsp;&nbsp;
		<a th:href="@{/matricula/ingresar}" class="btn btn-danger shadow" data-toggle="tooltip" data-placement="bottom" title="Ingresar matrícula">+ Matricular Estudiante</a>
	</div>
</div>
<br><br>
<div class="container">
	<div class="row g-3 align-items-center">
		<div class="col-auto">
			<div class="row">
				<div class="col">
				<form id="filtroForm" action="#" th:action="@{/filtrarcurso}" method="post" th:object="${filtrocurso}">
					<label class="fw-bold">Curso</label>
					<select id="filtroSelect" class="form-select" name="filtrocurso" >
						<option th:value="0">Seleccione...</option>
						<option class="text-uppercase" th:each="c : ${cursos}" th:value="${c.id_curso}" th:text="${c.nivel} + ' ' + ${c.letra}" th:selected="${c.id_curso == filtrocurso}"></option>
					</select>
					</form>
				</div>
			</div>
		</div>
		<div class="col-auto">
		<label class="fw-bold">Estado</label>
			<form id="filtroForm2" action="#" th:action="@{/filtrarestado}" method="post" th:object="${filtroestado}">
				<select id="selectestado" name="filtroestado" class="form-select">
					<option value=""  >Seleccione...</option>
					<option value="matriculado"  th:value="matriculado" th:selected=" True == filtroestado">Matriculado</option>
					<option value="retirado" th:value="retirado" th:selected=" False == filtroestado">Retirado</option>
				</select>
			</form>
		</div>
		<div class="col-auto">
			<div class="row g-2">
				<div class="col-auto">
					<form action="#" th:action="@{/filtrarnombre}" method="post">
					<label class="fw-bold">Búsqueda</label>
				    	<input class="form-control" name="filtronombre"   id="filtronombre" th:value="${filtronombre}" placeholder="Buscar Estudiante">
				 	</form>
				 </div>
				 <div class="col-auto">
				 	<label class="fw-bold">Refresque</label><br>
					<a class="btn btn-warning shadow" th:href="@{/matricula}" data-toggle="tooltip" data-placement="bottom" title="Refrescar"><i class="fa-solid fa-arrows-rotate"></i></a>
				 </div>	

			</div>
		</div>

	</div>
</div>
<br><br><br>
<div class="container text-center">
	<label class="h6">Total matrículados: <span class="fw-bold" th:text="${matriculados}"></span></label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
	<label class="h6">Total hombres: <span class="fw-bold" th:text="${hombres}"></span></label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
	<label class="h6">Total mujeres: <span class="fw-bold" th:text="${mujeres}"></span></label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
	<label class="h6">Total otros: <span class="fw-bold" th:text="${otros}"></span></label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</div>
<br><br><br><br>

<div class="container">
	<div class="d-flex justify-content-end">
		<a href="#" class="btn btn-info disabled" data-toggle="tooltip" data-placement="bottom" title="PRÓXIMAMENTE">Carga N° Matrículas</a>
	</div>
	<br>
	<table id="tablacontenido" class="table table-hover text-center border rounded">
		<thead class="table table-primary">
			<tr>
				<th class="fw-bold">N° matrícula</th>
				<th class="fw-bold">RUN</th>
				<th class="fw-bold">Nombre</th>
				<th class="fw-bold">PIE</th>
				<th class="fw-bold">Curso</th>
				<th class="fw-bold">Nivel de enseñanza</th>
				<th class="fw-bold">Acepta Religión</th>
				<th class="fw-bold">Estado</th>
				<th class="fw-bold">Acciones</th>
			</tr>
		</thead>
		<tbody>
			<tr th:each="e : ${estudiantes}">
				<td th:text="${e.numero_matricula}"></td>
				<td th:text="${e.run_estudiante}"></td>
				<td th:text="${e.nombre} + ' ' + ${e.apaterno} + ' ' + ${e.amaterno}"></td>
				<td  th:if="${e.es_pie} == True" class="bg-warning">SI</td>
				<td  th:if="${e.es_pie} == False" class="bg-primary" >NO</td>
				<td th:each="c : ${cursos}" th:if="${c.id_curso == e.curso_id}" th:text="${c.nivel} + ' ' + ${c.letra}"></td>
				<td th:each="c : ${cursos}" th:if="${c.id_curso == e.curso_id}" th:text="${c.nivel_ensenanza}"></td>
				<td th:if="${e.acepta_clases_religion} == True" th:text="Si"></td>
				<td th:if="${e.acepta_clases_religion} == False" th:text="No"></td>
				<td th:if="${e.estado} == True" class="bg-success rounded"  th:text="Matriculado"></td>
				<td th:if="${e.estado} == False" class="bg-danger rounded">Retirado</td>
				<td>
							<a th:href="@{/resumenMatricula/} + ${e.run_estudiante}" class="btn btn-light" data-toggle="tooltip" data-placement="bottom" title="Ver matrícula en detalle"><i class="fa-regular fa-user"></i></a>
							<a th:href="@{/matricula/modificar/} + ${e.run_estudiante}" class="btn btn-light" data-toggle="tooltip" data-placement="bottom" title="Editar"><i class="fa-solid fa-pencil"></i></a>
							<a th:href="@{/matricula/retirada/} + ${e.run_estudiante}" th:if="${e.estado} == True" class="btn btn-light" data-toggle="tooltip" data-placement="bottom" title="Retirar matrícula" ><i class="fa-solid fa-ban"></i></a>
							<a th:href="@{/matricula/recuperada/} + ${e.run_estudiante}" th:if="${e.estado} == False" class="btn btn-light" data-toggle="tooltip" data-placement="bottom" title="Recuperar matrícula" ><i class="fa-solid fa-hammer"></i></a>
							<a th:href="@{/resumenMatricula/} + ${e.run_estudiante} + '?format=pdf'" target="_blank" class="btn btn-light" data-toggle="tooltip" data-placement="bottom" title="Descargar matrícula"><i class="fa-solid fa-file-arrow-down"></i></a>
				</td>
			</tr>		
		</tbody>
	</table>
</div>
<br><br><br><br>

<script>

	document.getElementById('filtroSelect').addEventListener('change', function() {
		document.getElementById('filtroForm').submit();
		
	});
	
	document.getElementById('selectestado').addEventListener('change', function() {
		document.getElementById('filtroForm2').submit();
	});
	
</script>


</body>
</html>